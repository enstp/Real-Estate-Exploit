using System;
using System.Drawing;
using System.IO;

namespace RE.Core.Extensions
{
    public static class ImageExtensions
    {
        public static Bitmap ToBitmap(this byte[] picture)
        {
            using var ms = new MemoryStream(picture);
            return new Bitmap(ms);
        }

        public static byte[] ToByteArray(this Bitmap picture)
        {
            var converter = new ImageConverter();
            return (byte[])converter.ConvertTo(picture, typeof(byte[]));
        }

        public static string ToBase64(this byte[] byteArray)
        {
            return Convert.ToBase64String(byteArray, 0, byteArray.Length);
        }

        public static void SaveTo(this byte[] picture, FileInfo fileInfo)
        {
            using var ms = new MemoryStream(picture);
            using var fs = new FileStream(fileInfo.FullName, FileMode.Create);
            ms.WriteTo(fs);
        }
    }
}

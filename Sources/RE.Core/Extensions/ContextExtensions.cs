using Microsoft.AspNetCore.Http;

namespace RE.Core.Extensions
{
    public static class ContextExtensions
    {
        public static bool HasAddressSet(this HttpContext context)
        {
            var address = context.Connection.RemoteIpAddress;
            var originalAddress = context.GetTunneledIpAddress();
            return address.IsSet() || !string.IsNullOrEmpty(originalAddress);
        }

        public static string GetTunneledIpAddress(this HttpContext context)
        {
            return context.Request.Headers["X-Forwarded-For"].ToString(); // set by Ngrok service
        }
    }
}
